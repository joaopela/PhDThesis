\chapter{Event Reconstruction and Physics Objects}
\label{CHAPTER:EventReconstructionPhysicsObjects}

\glsresetall % Resetting all acronyms

This chapter describes how the \gls{CMS} detector produces physics objects from the information collected at each event. The \glsreset{VBF} Higgs to invisible analysis uses almost all the physics objects produced by the detector and for this uses information from all the experiment sub-detectors. The following sections detail for each of these objects how they are reconstructed and what are the choices made to filter them.

\section{Tracks}

%Writing

\cite{ARTICLE:CMSTrackReconstruction}

\cite{ARTICLE:KalmanFilteringTrackVertexFitting}

\cite{ARTICLE:CMSMeasurmentTrackEfficiency}

\section{Primary Vertex Reconstruction}

%Status: DONE

The \gls{LHC} can produce extreme collision intensities which are obtained partially by having multiple collisions happening at each bunch crossing. As it has been discussed in section \ref{SUBSECTION:ExperimentalApparatus_CMS_RunningAndPerformance} an average of 21 simultaneous collisions happened per bunch crossing in the \gls{CMS} experiment during 2012. In this environment, it is crucial to identify the \gls{PV} and the particles that come from it. This information can then be used to reject particles coming from other additional collisions and to identify displaced vertices which can be the signature of long lived particles like b-mesons.

The individual tracks are reconstructed making use of the inner tracker. Each vertex is initially seeded by two tracks with separation in \textit{z} less than $1\,\centi\meter$. Then remaining track are clustered to seed vertex with the \gls{DA} algorithm\cite{ARTICLE:DeterministicAnnealing}. After the clustering process is done, the position of each vertex is recomputed using the adaptive vertex fitter algorithm\cite{ARTICLE:AdaptiveVertexFitting}. In this algorithm weights, $w_{i}$ are assigned to each track according to how compatible they are with the fitted vertex position. Weight vary from 1 to 0, being that track assigned weights of close 1 are highly compatible with the vertex and close 0 would be given to low compatibility tracks. Then we can define the number of degrees of freedom of the new fit as:

\begin{equation}
n_{dof}(vertex)=2\sum\limits_{i}^{tracks} w_i - 3
\end{equation}

This variable can be used to distinguish real proton-proton interactions from misclustered vertices, since it is correlated with the number of tracks compatible with that specific vertex\cite{ARTICLE:CMSTrackingAndPrimaryVertex}.

The \gls{PV} is defined as the vertex with highest sum of associated tracks \pt squared. In situations were no vertex can be reconstructed, like if there is a tracking failure, the beam spot position is assumed. Knowing precisely the interaction point allows to determine particle candidate quantities relative to it which allow for better object identification and pile-up control. 

Most \gls{CMS} analysis, including the ones presented in this thesis, require explicitly that a good vertex is reconstructed with the following characteristics:

\begin{itemize}
  \item We require a real reconstructed vertex from tracks, not the beam spot.
  \item A minimum number of degrees of freedom: $n_{dof}>4$.
  \item Collision must be near the interaction point. We require longitudinal distance to be $|z|<=24\,\centi\meter$.
  \item We required the collision be be close to the beam line. Radial distance to beam line: $d_{xy}<2\,\centi\meter$. 
\end{itemize}

%\subsection{Event quality filters}

\section{Electron}

%Status: Writing

In the \gls{CMS} experiment electrons are reconstructed by matching energy clusters in the \gls{ECAL} with tracks coming from the inner tracking system. Unfortunately, electrons can loose and disperse significant amounts of energy until they reach the \gls{ECAL}. While they transverse the inner tracker they may emit photons through bremsstrahlung and in turn this photon can convert to $e^+e^-$ pairs. About 35\% of the electron radiate at least 70\% of their energy in this way \cite{ARTICLE:CMSElectronReconstruction}. This spread of energy is mostly in $\phi$ due to the applied magnetic field. \cite{ARTICLE:CMSElectronReconstructionECAL}. Dedicated algorithms were developed to combine the the \gls{ECAL} energy deposits, into a so called \textit{super-clustering algorithm}, of the initial electron and its emissions.

Different algorithms are used in the barrel and endcaps regions. In the barrel region we explore the simple $\eta-\phi$ geometry with the ``hybrid clustering algorithm''. The procedure started by identifying \textit{seed crystals} with $E_\perp>1\,\GeV$. We form a domino around this seed in the $\eta$ direction of $3 \times 1$ or $5 \times 1$ crystals centred at the seed. Additional dominoes are added in both $\phi$ direction in an attempt to collect the bremsstrahlung emissions up to $\Delta\phi \approx 0.3\,\radian$. Any domino with energy below $100\,\MeV$ is disregarded. The resulting additional sub-clusters must have its own seed with $E_\perp>350\,\MeV$ and they are all combined to form the final \textit{supercluster}. 

In the encaps the ``$\text{Multi-}5 \times 5$'' is used. In the region of the detector the geometry is more complex and does not follow a simple $\eta-\phi$ symmetry. We start by selecting for seeds the crystals which are local maxima over their four direct neighbours and have a deposit of $E_\perp>0.18\,\GeV$. Then, and starting with the seeds with highest $E_\perp$, we collect the energy around them into clusters of $5 \times 5$ crystals. We then search for similar seeds and form clusters that can overlap within $\Delta\eta<0.07$ and $\Delta\phi<0.3\,\radian$ of the initial seed. Those clusters are then combined into a single \textit{supercluster} which needs to have at least $E_\perp>1\,\GeV$. The \textit{supercluster} is then extrapolated to the \gls{ECAL} preshower
by clustering the energy within $\Delta\eta<0.15$ and $\Delta\phi<0.45$ around the most energetic cluster and adding it to the \textit{supercluster} itself\cite{ARTICLE:CMSElectronReconstruction8TeV}.

%Tracking
\gls{CTF}


\section{Muon}

\cite{ARTICLE:CMSMuonReconstruction7TeV}

\section{Particle Flow}

\cite{ARTICLE:CMSComissioningOfParticleFlow}

\cite{ARTICLE:CMSParticleFlowEventRecontruction}

\cite{ARTICLE:CMSComissioningOfParticleFlowWithMinBias}

\section{Jets}

\subsection{Jet Clustering}

\cite{ARTICLE:TowardsJetography}

\cite{ARTICLE:AntiKtAlgorithm}

\cite{ARTICLE:FastJetUserManual}

\subsection{Jet Energy Corrections}

\cite{ARTICLE:CMSDeterminationJetEnergyCalibration}

\cite{ARTICLE:PileupSubtractionJetAreas}

\section{Taus}

\section{Missing Transverse Energy}

\cite{ARTICLE:CMSMissingTransverseEnergyPerformance}

\cite{ARTICLE:CMSMETPerformance8TeV}


% \clearpage
% \input{data/ParkedData_CrossCheckAnalysis/section_Introduction}
% \input{data/ParkedData_CrossCheckAnalysis/section_Samples}
% \input{data/ParkedData_CrossCheckAnalysis/section_Objects}
% \input{data/ParkedData_CrossCheckAnalysis/section_SignalSelection}
% \input{data/ParkedData_CrossCheckAnalysis/section_BackgroundEstimation}
